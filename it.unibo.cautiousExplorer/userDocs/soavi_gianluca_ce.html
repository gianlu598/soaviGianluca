<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <!--
<link rel="stylesheet" type="text/css" href="../css/issStyle1.css">
<script type="text/javascript" src="../css/issStyle.js"></script>
-->
<style type="text/css">
body
{
    margin-left:  30px;
    margin-right: 30px;
};

P
{
    font-family: Tahoma;
    font-size: 10pt;
};

a, a:visited, a:active, a:link, a:hover {
    text-decoration: underline;
    color: #545454;
    background-color: transparent;
	font-size: 93%;
}

a:hover {
    background-color: #cccccc;
}


hr {
    clear: both;
    height: 1px;
    color: #242424;
    background-color: transparent;
}

h1, h2, h3 {
    color: #242424;
    clear: left;
    font: 100% Tahoma, Helvetica, Arial, sans-serif;
    margin-bottom: 0.5em;
    padding-top: 0.5em;
	border-radius: 10px;
	padding: 5px;
}

top {
	width: 100%;
}


#i {
    color: #ff1010;
}
tt{
	font-family: "Arial";
    font-size: 90%;
	color: #006600;
}
em{
	font-family: "Arial";
    font-size: 80%;
	font-weight: bold;
	border-style:solid;
	border-color: #abe876;
    color: #1632cc;
}
bc{
	font-family: "Arial";
	font-size: 90%;
	font-weight: bold;
    color: #990000;
	background-color: #fcf8c7;
}
ks{
	font-family: "Arial";
	font-weight: bold;
    color: #0000CD	;
	font-size: 90%;
}
kc{
	font-family: "Arial";
	font-weight: bold;
    color: #008000	;
	font-size: 90%;
}
pre{
	font-family: "Consolas";
	font-size: 85%;
	background-color: #f5f5f5;
	border: 1.5px solid silver;
	padding: 5px;
}
m{
	font-family: "Helvetica";
	line-height: 100%;
 	font-size: 75%;
}
div.body{
	 
    font-size: 18px;
}
k{
    color: #990000;
	font-weight: bold;
	font-size: 90%;
}
h1 {
    font-size: 150%;
    background-color: #b2c0ff;
	padding: 10px;
}

h2 {
    background-color: #9ed8ff;
    font-size: 130%;
}

h3 {
	background-color: #e6ccff;
    font-size: 100%;
}
h4 {
    background-color: #ccffcc;
    font-size: 100%;
	width: 95%;
	border-radius: 5px;
	padding: 2px;
}
h5 {
    background-color: #d5ffb0;
    font-size: 100%;

}
div.req{
	background-color: #d9ffb3;
    font-size: 18px;
	width: 700px;
    border: 3px solid green;
    padding: 15px;
    margin: 10px;
}
div.remark{
	background-color: #E3F2FD;
    border: 1.5px solid #d5f2ed;
    padding: 15px;
    margin: 10px;
	border-radius: 25px;
}
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}

ol, ul, li {
  margin: 0;
  margin-left: 10px;
  padding: 0;
  padding-bottom: 5px;
}

table, th, td {
	border: 1px solid black;
}

img {
	border: 1.5px solid #d5f2ed

}

a, a:visited, a:active, a:link, a:hover {
    text-decoration: underline;
    color: #545454;
    background-color: transparent;
}

div.wrapdesc{
	width: 90%;
	margin: auto;
}

div.imagedesc{
	width: 85%;
	margin: auto;
}
</style>
    
<head>
   
<title>Cautious Explorer</title></head>
    
<body>
<div id="top">
<h1>Lab ISS | the project cautiousExplorer <font size="5"></font> </h1>
</div>  

<div class="body"> 
<h2>Introduction</h2>
 <p>This case-study starts to deal with the design and development of proactive/reactive software systems that use aynchronous exchange of information. </p>
 
<h2>Requirements</h2>
<div class="remark">
Design and build a software system that allow the robot described in 
<a href="https://htmlpreview.github.io/?https://github.com/anatali/issLab2021/blob/master/it.unibo.virtualRobot2020/userDocs/VirtualRobot2021.html" target="lab"><em>VirtualRobot2021.html</em></a>
 to exibit the following behaviour:
<ul>
<li>the robot lives in a closed environment, delimited by walls that includes one or more devices (e.g. sonar) able to detect its presence;</li>
<li>the robot has a <ks>den</ks> for refuge, located near a wall;</li>
<li>the robot works as an <i>explorer of the environment</i>. Starting from its <ks>den</ks>,  the robot moves
(either randomly or - preferably - in a more organized way) with the aim to find the fixed obstacles around the <ks>den</ks>. 
The presence of mobile obstacles is (at the moment) excluded;</li>
<li>since the robot is <i>'cautious'</i>,  it  returns immediately to the <ks>den</ks> as soon as it finds an obstacle.
Optionally, it should also return to the <ks>den</ks> when a sonar detects its presence;
</li>
<li>the robot should remember the position of the obstacles found, by creating a sort of 'mental map' of the environment.</li>
</ul>
</div>

 <h3>Delivery</h3>
The customer requires to receive the completion of the analysis (of the requirments and of the problem)  by <k>Friday 12 March</k>. 
Hopefully, he/she expects to receive also (in the same document) some detail about the project.<br>
The name of the file (in pdf) should be:
<pre>cognome_nome_ce.pdf
</pre>
 
 

<h2>Requirement analysis</h2>
<div class="remark">
 Our <b>interaction with the customer</b> has clarified that the customer intends:
 <ul>
 <li>for <ks>robot</ks>: a device able to execute move commands sent over the network, as described in the document
<a href="VirtualRobot2021.html#commands" target="web"><em>VirtualRobot2021.html</em></a> provided by the customer;</li>
 <li>for <ks>closed environment</ks>: a room delimited by walls;</li>
 <li>for <ks>sonar</ks>: a device which detect and notify the presence of an object when the object is located in a certain part of the closed environment; </li>
 <li>for <ks>den</ks>: the robot starting position, located along the room boundary, and the position to which it must return when certain situations occur, as described in the requirements; </li>
 <li>for <ks>fixed obstacle</ks>: an object, placed in a certain fixed position in the room, which is an impediment to a robot movement; </li>
 <li>for <ks>mental map</ks>: a representation of the closed environment where the robot is located; </li>

 <li>for <i><b>detect its presence</b></i>: to know, with the help of specific sensors, if an object is located in a certain part of the closed environment; </li>
 <li>for <i><b>move</b></i>: the robot can move forward, backward and turn left and right; </li>
 <li>for <i><b>find the fixed obstacles</b></i>: when the robot detects an obstacle, and its impact sensors emit collision data, as described in 
 <a href="VirtualRobot2021.html#commands" target="web"><em>VirtualRobot2021.html</em></a> provided by the customer; </li>
 <li>for <i><b>returns immediately to the den</b></i>: as soon as the robot finds an obstacle, it must move until it returns to its starting position; </li>
 <li>for <i><b>remember</b></i>: the robot should have and should be able to consult a representation of the closed environment where it is placed. </li>
 </ul>

<h3>User story</h3>
<table style="width:98%">
<tbody>	
<tr>
<td style="width:70%" >
As user, I put the robot in its <ks>den</ks> (an arbitrary position along the boundary of the closed environment); afterwards, I activate the 
<ks>cautiousExplorer</ks> application that moves the robot inside the room until it finds an obstacle or a sonar detects it. 
<br/>
The  application cannot be interrupted by any user-command.
<br/><br/>
When the application terminates, I expect that the robot has returned to its den (starting position) and it has memorized its path in 
a 'mental map'.
</td>
<td><center><img src="./img/userStory.png" alt="UserStory" width="90%" ></center>
</td>
</tr>
 </tbody>
</table>

<h3>Test plan</h3>
<table style="width:98%">
<tbody>	
<tr>
<td style="width:50%" >
It is necessary to verify that the robot, after encountering an obstacle or after being detected by the sonar, returns to the starting point (den).
</td>
<td><div class="remark">
The verification must be done via software, without the intervention of a human user.
</div></td>
</tr>
 </tbody>
</table>

</div>
<h2>Problem analysis</h2>
 <div class="remark" align="justify">
	<h3>Main aspects</h3>
		In the <a href="VirtualRobot2021.html#commands" target="web">VirtualRobot2021.html</a> the customer states
		that the robot can receive move commands in two different ways:
		<ul>
			<li>by sending messages to the port <tt>8090</tt> using  <ks>HTTP POST</ks> </li>
			<li>by sending messages to the port <tt>8091</tt> using a <ks>websocket</ks> </li>
		</ul>
		<br/>
		<!--
		Un altro problema, riguardante la comunicazione, sorge quando si prende in considerazione il requisito opzionale che prevede che il 
		robot torni alla den quando il sonar lo rileva.
		Quando per l'invio dei comandi al robot si può utilizzare tranquillamente una comunicazione request-response, per quanto riguarda il sonar
		quel tipo di comunicazione non è adatto; c'è bisogno di una comunicazione che utilizzi le dispatch, poiché le informazioni dal sonar
		arrivano in maniera imprevedibile e asincrona.
		-->
		Another problem, related to the communication, arises when we consider the optional requirement <i>"Optionally, it should also return to the den 
		when a sonar detects its presence"</i>, which says that the robot has to return to its starting position when the sonar detects it.<br/>
		When a <b>request-response communication can be used to send movement commands to the robot</b>, as far as sonar is concerned, 
		that type of communication is not suitable anymore.<br/> 
		<b>The sonar requirement requires a communication that uses dispatches</b>, since the information from the sonar 
		arrives unpredictably and asynchronously.<br/> In this case, considering the type of communication available, a <tt>websocket</tt> communication 
		must be used to implement a solution for the requirement.
		<br/><br/>
		With respect to the technological level, there are many libraries in many programming languages that support the required protcols. 
		
			
	<h3>Logical architecture</h3>
	<table style="width:98%">
		<tbody>	
		<tr>
			<td style="width:60%"><div class="remark">
			We must design and build a <k>distributed system</k> with two software macro-components:
			<ol>
				<li>the <a href="VirtualRobot2021.html" target="web"><ks>VirtualRobot</ks></a>, given by the customer</li>
				<li>our <ks>cautiousExplorer</ks> application that interacts with the robot </li>
			</ol>
			A first scheme of the logical architecture  of the systems can be defined as shown in the figure
			(for the meaning of the symbols, see the <a href="./img/legenda.png" target="web">legenda</a>)
			</div></td>
			<td><div class="remark">
				<center><img src="./img/logicArch0.png" alt="logicArch0" width="100%" ></center>
			</div></td>
		</tr>
		</tbody>
	</table>
	
	<br/><br/>
	We observe that:
	<ul>
		<li>The specification of the exact 'nature' of our <em>cautiousExplorer</em> software is left to the designer. 
		However, we can say here that is it <b>not a database, or a function or an object</b>.  
		<li>To make our <em>cautiousExplorer</em> software <k>as much as possibile independent</k> from the underlying communication protocols,
		the designer could make reference to proper design pattern</li>
		<li>A basic test to meet the main requirements could be (the sonar and the mental map requirements are not satisfied):
<pre>
let us define <kc>emum direction {UP,DOWN,LEFT,RIGHT}</kc>
the robot start in the <tt>den</tt> position, direction=DOWN 
	1) send to the robot the request to execute the command <kc>moveForward</kc> 
	and continue to do it, until the answer of the request becomes 'false' 
	(collision with an obstacle);
	2) send to the robot the request to execute the <kc>moveBackward</kc>
	as many times as the command <b>moveForward</b> has been executed
	to bring the robot to the starting position.
</pre>
		</li>
	</ul>
 </div>

<h2>Test plans</h2> 
<div class="remark">
To check that the basic test was successful, we could keep track of the moves done by the robot.
For example:

<pre>
...
let us define <kc>String moves="";</kc> and <kc>int counter=0;</kc>
	1) send to the robot the request to execute the command <kc>moveForward</kc>;
	if the answer is 'true' <ks>append the symbol "w"</ks> to <kc>moves</kc>, increase <kc>counter</kc> 
	and continue to do 1) until the answer of the request becomes false; 
	2) for <kc>counter</kc> times:
		send to the robot the request to execute the command <kc>moveBackward</kc> 
		and <ks>append the symbol "b"</ks> to <kc>moves</kc> until the answer is false;
</pre>

In this way, when the application terminates, the string <kc>moves</kc> should have the typical structure of a 
regular expression, that can be easily checked with a TestUnit software:
<pre><kc>moves</kc>: <ks>"w*b*"</ks>     <kc><ks>*</ks> : repetion N times(N>=0 and N is the same for "w" and "b") </pre>

<h4>JUnit code</h4>
<div align="center" width="70%">
	<img src="img/preTest.png" alt="pre test">
</div>
<div align="center" width="70%">
	<img src="img/mainTest.png" alt="main test">
</div>
</div>

<!-- USEFUL
<table style="width:100%" border="1">
<tr>
<td style="width:50%">
</td>
<td></td>
</tr>
</table>
-->
	 </div>     	
<br/><br/> 	
</div>  

<div style="background-color:rgba(86, 56, 253, 0.9); width:60%;text-align:left;color:white">
By Gianluca Soavi email: gianluca.soavi@studio.unibo.it
<img src="./img/fototessera.jpg" alt="mbot" width="15%" height="15%">
</div> 
</body>
</html>